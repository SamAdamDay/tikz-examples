%!TEX root = ../tikz-figures.tex

\section*{Trees}

\begin{equation*}
	\index{foreach}
	\index{foreach!backwards}
	\index{variable!pgfmathsetmacro}
	\index{variable!from expression}
	\index{variable!pgfmathparse}
	\index{clip}
	\index{path!curved}
	\index{node on path!fraction position}
	\index{math functions!mod}
	\begin{tikzpicture}
		\pgfmathsetmacro{\qpoints}{4}; % Number of q_n's to draw
		\pgfmathsetmacro{\qlabels}{2}; % Number of q_n's to label
		\begin{scope}
			\coordinate (x) at (0,0);
			\clip ($(x)+(135:7)$) rectangle ($(x)+(5,0)$);
			\fill[lightgray] (x) -- ($(x)+(135:3)$) .. controls +(1,1) and +(-1,-0.5) .. ($(x)+(45:3)$) -- (x);
			\draw (x) edge +(135:7) edge +(45:7);
			\draw ($(x)+(135:3)$) .. controls +(1,1) and +(-1,-0.5) .. ($(x)+(45:3)$)
				coordinate[pos=0.2] (q)
				coordinate[pos=0.8] (qinf);
			\draw (x) edge (q) edge (qinf);
			\fill[lightgray!50!white] (q) -- +(110:4) -- +(70:4) --cycle;
			\node[point] at (q) [label=below left:$q$] {};
			\draw (q) edge +(110:4) edge +(70:4);
			\draw[dotted] (qinf) edge +(110:4) edge +(70:4);
			\foreach \n in {0, ...,\qpoints}
			{
				\coordinate (q\n) at ($(qinf) + (0,{2/(2^\n)})$) {};
			}
			\foreach \n in {0, ...,\qpoints}
			{
				\pgfmathsetmacro{\m}{\qpoints-\n}
				\pgfmathparse{100/(mod(\m,2)+1)}
				\fill[lightgray!\pgfmathresult!white] (q\m) -- +(110:4) -- +(70:4) --cycle;
				\draw (q\m) edge +(110:4) edge +(70:4);
				\node[point] at (q\m) {};
			}
			% \draw (qinf) -- (q0);
			\draw node at ($(x) + (3,1)$) {$\us x^{\mathrm{NonPara}(X)}$} edge[->] ($(x) + (0,1.5)$);
		\end{scope}
		\foreach \n in {0,...,\qlabels}
		{
			\draw node at ($(qinf) + (0,{2/(2^\n)}) + (1.5,1)$) {$q_\n$} edge[->] (q\n);
		}
		\node[point] at (x) [label=right:$x$] {};
	\end{tikzpicture}
\end{equation*}

\begin{equation*}
	\index{path!curved}
	\index{node on path}
	\index{function plot}
	\index{transformation!slant}
	\begin{tikzpicture}
		\begin{scope}
			\filldraw[lightgray] (0,0) node[point] {} -- (-2,4) -- (0,4) --cycle; 
			\draw[dotted] (0,0) -- (-2,4);
			\draw[dotted] (0,0) -- (2,4);
			\draw (0,3) node (Ca) {} -- (1.5,4) node (Cb) {};
			\draw[decoration={calligraphic brace,amplitude=5pt}, decorate, line width=1.25pt]
				($(Cb) + (0.1,-0.1)$) -- node[below right] {$C$} ($(Ca) + (0.1,-0.1)$);
			\node at (-0.75,3) {$\dom(\ell)$};
		\end{scope}
		\begin{scope}[xshift=-120, yshift=-110, scale=1.5]
			\draw[->] (0,0) -- node[left] {$f$} (0,2);
			\draw (0,0) node (a1a) {} -- (2,0) node (a1b) {};
			\draw[decoration={calligraphic brace,amplitude=5pt}, decorate, line width=1.25pt]
				($(a1b) + (0,-0.1)$) -- node[yshift=-12] {$C$} ($(a1a) + (0,-0.1)$);
			\begin{scope}
				\draw (0,0) node (l1a) {} .. controls +(0.2,0) and (0.3,0.2) .. (0.5,0.2) node (l1b) {};
			\end{scope}
			\begin{scope}[yshift=10]
				\draw (0.5,0.2) node (l1c) {} .. controls +(0.3,0) .. (1,0.3) node (l1d) {};
			\end{scope}
			\begin{scope}[yshift=15]
				\draw (1,0.3) node (l1e) {} .. controls +(0,0.3) .. (1.5,0.6) node (l1f) {};
			\end{scope}
			\begin{scope}[yshift=30]
				\draw (1.5,0.6) node (l1g) {} -- (2,0.8) node (l1h) {};
			\end{scope}
			\begin{scope}[every path/.style={lightgray, dotted}]
				\draw (l1b) -- (l1c);
				\draw (l1d) -- (l1e);
				\draw (l1f) -- (l1g);
			\end{scope}
		\end{scope}
		\begin{scope}[xshift=40, yshift=-110, scale=1.5]
			\draw[->] (0,0) -- node[left] {$\wh \ell$} (0,2);
			\draw (0,0) node (a2a) {} -- (2,0) node (a2b) {};
			\draw[decoration={calligraphic brace,amplitude=5pt}, decorate, line width=1.25pt]
				($(a2b) + (0,-0.1)$) -- node[yshift=-12] {$C$} ($(a2a) + (0,-0.1)$);
			\begin{scope}[yslant=0.35]
				\draw (0,0) node (l1a) {} .. controls +(0.2,0) and (0.3,0.2) .. (0.5,0.2) node (l1b) {};
				\draw (0.5,0.2) node (l1c) {} .. controls +(0.3,0) .. (1,0.3) node (l1d) {};
				\draw (1,0.3) node (l1e) {} .. controls +(0,0.3) .. (1.5,0.6) node (l1f) {};
				\draw (1.5,0.6) node (l1g) {} -- (2,0.8) node (l1g) {};
			\end{scope}
		\end{scope}
		\begin{scope}[xshift=0, yshift=-110, scale=1.5]
			\draw[->] (-0.4,0.8) -- (0.4,0.8);
		\end{scope}
		% \begin{scope}[every path/.style={dashed}]
		% 	\draw (Ca) -- (a1a);
		% 	\draw (Cb) -- (a1b);
		% 	\draw (Ca) -- (a2a);
		% 	\draw (Cb) -- (a2b);
		% \end{scope}
	\end{tikzpicture}
\end{equation*}

\begin{equation*}
	\index{path!partly rounded}
	\index{array!two-dimensional}
	\index{foreach}
	\index{variable!pgfmathsetmacro}
	\index{arrows!bar}
	\begin{tikzpicture}
		\def\twigs{{{0.0,0.1},{0.1,0.1},{0.3,0.15},{0.4,0.2},{0.5,0.3},{0.6,0.3},{0.7,0.4},{0.8,0.45}, {1.0,0.55},{1.2,0.6},{1.3,0.6},{1.5,0.7},{1.6,0.7},{1.7,0.75},{1.8,0.8},{1.9,0.8},{2.0,0.9}}}
		% \def\twigs
		\pgfmathsetmacro{\twigmax}{16}
		\coordinate (p) at (0,0);
		\begin{scope}[xscale=2, yscale=1, xshift=-30, yshift=100]
			\filldraw[lightgray] (p) {[rounded corners=15] -- (0.8,0.5) -- (2.3,0.5)} -- cycle;
			\foreach \i in {0,...,\twigmax}
			{
				\draw (\twigs[\i][0],0) node[point] (a\i) {} -- (\twigs[\i][0],\twigs[\i][1]);
			}
			\draw[dashed] (-0.2,0.5) -- (2.2,0.5);
			\draw[Bar-Bar] (2.4,0) --node[right] {$2\ep$} (2.4,0.5) ;
			\draw[brace]
				(2,-0.2) -- node[yshift=-10] {$A^*$} (1,-0.2);
			\draw[brace]
				(2,-0.8) -- node[yshift=-10] {$A$} (0,-0.8);
		\end{scope}
		\node[point] at (p) {};
		\draw[dotted] (p) edge (-4,4) edge (4,4);
		\node at (0.4,1.5) {$Y^*$};
	\end{tikzpicture}
\end{equation*}

\begin{equation*}
	\index{arrows!bar}
	\begin{tikzpicture}
		\begin{scope}[every node/.style={point}]
			\node (p) at (0,0) [label=below:$p$] {};
			\node (m) at (0,2) {};
			\node (x) at (-2,4) [label=right:$x$] {};
			\node (y) at (2,4) [label=left:$y$] {};
		\end{scope}
		\node (ml) at ($(m) + (1.5,-0.3)$) {$x \wedge y$};
		\draw[->] (ml)  -- (m);
		\draw (p) -- (m) -- (x);
		\draw (m) -- (y);
		\begin{scope}[every path/.style={blue,{Bar-Bar}}]
			\draw ($(p)+(-0.6,0)$) -- node[left] {$\ell(x \wedge y)$} ($(m)+(-0.6,0)$);
			\draw ($(p)+(-0.2,0)$) -- ($(m)+(-0.185,-0.077)$) -- node[below left] {$\ell(x)$} ($(x)+(-0.141,-0.141)$);
			\draw ($(p)+(0.2,0)$) -- ($(m)+(0.185,-0.077)$) -- node[below right] {$\ell(y)$} ($(y)+(0.141,-0.141)$);
			% \draw ($(p)+(-0.2,0)$) -- ($(m)+(-0.2,0)$) -- node[right left] {$\ell(x)$} ($(x)+(-0.141,-0.141)$);
		\end{scope}
	\end{tikzpicture}
\end{equation*}